<!doctype html>
<html lang="az">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Top Sales â€” Elan PlatformasÄ±</title>
  <meta name="description" content="Top Sales: SadÉ™, sÃ¼rÉ™tli vÉ™ mobil uyumlu elan platformasÄ±."/>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>ğŸ›’</text></svg>">
  <style>
    :root{
      --bg:#0b0c10; --card:#12131a; --muted:#8b93a7; --text:#f1f5f9; --brand:#6ee7b7; --brand-2:#22d3ee; --danger:#ef4444;
      --ring: 0 0 0 2px rgba(34,211,238,.35);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:linear-gradient(180deg,#0b0c10 0%, #0b1220 60%, #0b0c10 100%);color:var(--text)}
    a{color:inherit}
    .container{max-width:1200px;margin:0 auto;padding:16px}
    header{position:sticky;top:0;z-index:40;background:rgba(11,14,24,.7);backdrop-filter:saturate(160%) blur(10px);border-bottom:1px solid rgba(255,255,255,.08)}
    .topbar{display:flex;gap:12px;align-items:center;justify-content:space-between;padding:10px 16px}
    .brand{display:flex;align-items:center;gap:10px;font-weight:800;letter-spacing:.3px}
    .brand-badge{width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,var(--brand),var(--brand-2));display:grid;place-items:center;color:#062a2f;font-weight:900}
    .searchbar{display:flex;gap:8px;align-items:center;width:100%;max-width:760px}
    .input, select, textarea{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08);color:var(--text);border-radius:12px;padding:12px 12px;outline:none;transition:.2s}
    .input:focus, select:focus, textarea:focus{box-shadow:var(--ring);border-color:#22d3ee}
    .btn{border:none;border-radius:12px;padding:12px 14px;font-weight:700;cursor:pointer;transition:.2s;display:inline-flex;align-items:center;gap:8px}
    .btn-primary{background:linear-gradient(135deg,var(--brand),var(--brand-2));color:#062a2f}
    .btn-ghost{background:rgba(255,255,255,.06);color:var(--text);border:1px solid rgba(255,255,255,.08)}
    .btn-danger{background:var(--danger);color:white}
    .controls{display:flex;gap:8px;flex-wrap:wrap}
    .chips{display:flex;gap:8px;flex-wrap:wrap}
    .chip{padding:8px 12px;border-radius:999px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08);cursor:pointer}
    .chip.active{background:linear-gradient(135deg,var(--brand),var(--brand-2));color:#062a2f;border-color:transparent}

    main{padding:16px}
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:16px}
    .sidebar{grid-column:span 3;background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:14px;position:sticky;top:76px;height:fit-content}
    .content{grid-column:span 9}
    @media (max-width: 980px){.sidebar{grid-column:1/-1;order:2}.content{grid-column:1/-1;order:1}}

    .cards{display:grid;grid-template-columns:repeat(4,1fr);gap:16px}
    @media (max-width:1100px){.cards{grid-template-columns:repeat(3,1fr)}}
    @media (max-width:780px){.cards{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:520px){.cards{grid-template-columns:1fr}}

    .card{background:var(--card);border:1px solid rgba(255,255,255,.08);border-radius:18px;overflow:hidden;display:flex;flex-direction:column}
    .card .thumb{position:relative;aspect-ratio:16/11;background:#0f172a;overflow:hidden}
    .card img{width:100%;height:100%;object-fit:cover;display:block}
    .badge{position:absolute;left:10px;top:10px;background:rgba(0,0,0,.6);padding:6px 10px;border-radius:999px;font-size:12px}
    .fav{position:absolute;right:10px;top:10px;background:rgba(0,0,0,.6);border:none;border-radius:999px;width:36px;height:36px;color:#ffd7d7;display:grid;place-items:center;cursor:pointer}
    .card-body{padding:12px 14px;display:flex;flex-direction:column;gap:8px}
    .title{font-weight:800;line-height:1.2}
    .muted{color:var(--muted);font-size:14px}
    .price{font-weight:900;font-size:18px}

    .toolbar{display:flex;gap:8px;align-items:center;justify-content:space-between;margin:8px 0 16px 0;flex-wrap:wrap}
    .divider{height:1px;background:rgba(255,255,255,.08);margin:12px 0}

    dialog{border:none;border-radius:18px;background:var(--card);color:var(--text);padding:0;max-width:840px;width:92%}
    dialog::backdrop{background:rgba(0,0,0,.5);backdrop-filter:blur(2px)}
    .modal-header{padding:16px 18px;border-bottom:1px solid rgba(255,255,255,.08);display:flex;justify-content:space-between;align-items:center}
    .modal-body{padding:16px 18px}
    .two{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media (max-width:720px){.two{grid-template-columns:1fr}}

    .preview{display:grid;grid-template-columns:repeat(4,1fr);gap:8px}
    .preview div{aspect-ratio:1;border-radius:12px;overflow:hidden;border:1px dashed rgba(255,255,255,.15);display:grid;place-items:center}
    .preview img{width:100%;height:100%;object-fit:cover}

    footer{padding:28px 16px;color:var(--muted);text-align:center;border-top:1px solid rgba(255,255,255,.08)}

    .pill{padding:6px 10px;border-radius:999px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08);font-size:12px}
    .hidden{display:none}
  </style>
</head>
<body>
  <header>
    <div class="topbar container">
      <div class="brand" aria-label="Top Sales brendi">
        <div class="brand-badge" aria-hidden="true">TS</div>
        <div>
          <div style="font-size:18px;line-height:1">Top Sales</div>
          <div style="font-size:12px;color:var(--muted)">ElanlarÄ±nÄ± burada paylaÅŸ</div>
        </div>
      </div>
      <form id="searchForm" class="searchbar" role="search">
        <input id="q" class="input" type="search" placeholder="NÉ™ axtarÄ±rsan? (mÉ™s: iPhone 13, kirayÉ™, uÅŸaq velosipedi)" aria-label="AxtarÄ±ÅŸ"/>
        <select id="categoryFilter" aria-label="Kateqoriya">
          <option value="">BÃ¼tÃ¼n kateqoriyalar</option>
          <option>Telefon & Elektronika</option>
          <option>DaÅŸÄ±nmaz É™mlak</option>
          <option>NÉ™qliyyat</option>
          <option>Geyim & Aksesuar</option>
          <option>Ev & BaÄŸ</option>
          <option>UÅŸaq DÃ¼nyasÄ±</option>
          <option>Hobbi & Ä°dman</option>
          <option>DigÉ™r</option>
        </select>
        <select id="sort" aria-label="SÄ±ralama">
          <option value="newest">Æn yenilÉ™r</option>
          <option value="price-asc">QiymÉ™t: AÅŸaÄŸÄ±dan YuxarÄ±</option>
          <option value="price-desc">QiymÉ™t: YuxarÄ±dan AÅŸaÄŸÄ±</option>
          <option value="title-asc">Ad: Aâ†’Z</option>
        </select>
        <button class="btn btn-primary" type="submit" title="Axtar"><span>ğŸ”</span> Axtar</button>
      </form>
      <div class="controls">
        <button id="toggleTheme" class="btn btn-ghost" title="TÃ¼nd/AÃ§Ä±q rejim">ğŸŒ“</button>
        <button id="openCreate" class="btn btn-primary" title="Elan É™lavÉ™ et">â• Elan</button>
      </div>
    </div>
  </header>

  <main class="container">
    <div class="toolbar">
      <div class="chips" id="quickCats" aria-label="SÃ¼rÉ™tli kateqoriyalar">
        <span class="chip" data-cat="Telefon & Elektronika">Telefon</span>
        <span class="chip" data-cat="DaÅŸÄ±nmaz É™mlak">Æmlak</span>
        <span class="chip" data-cat="NÉ™qliyyat">NÉ™qliyyat</span>
        <span class="chip" data-cat="Geyim & Aksesuar">Geyim</span>
        <span class="chip" data-cat="Ev & BaÄŸ">Ev & BaÄŸ</span>
        <span class="chip" data-cat="UÅŸaq DÃ¼nyasÄ±">UÅŸaq</span>
        <span class="chip" data-cat="Hobbi & Ä°dman">Hobbi</span>
      </div>
      <div class="controls">
        <button id="loadDemo" class="btn btn-ghost" title="Demo elanlarÄ± yÃ¼klÉ™">ğŸ“¦ Demo</button>
        <button id="exportBtn" class="btn btn-ghost" title="JSON ixrac">â¬‡ï¸ Ä°xrac</button>
        <label class="btn btn-ghost" title="JSON idxal">
          â¬†ï¸ Ä°dxal <input id="importInput" type="file" accept="application/json" class="hidden" />
        </label>
        <button id="clearAll" class="btn btn-danger" title="BÃ¼tÃ¼n elanlarÄ± sil">ğŸ—‘ï¸ TÉ™mizlÉ™</button>
      </div>
    </div>

    <div class="grid">
      <aside class="sidebar" aria-label="FiltrlÉ™r">
        <h3 style="margin:6px 0 12px 0">FiltrlÉ™r</h3>
        <label class="muted">Maks. qiymÉ™t (AZN)</label>
        <input id="maxPrice" class="input" type="number" min="0" placeholder="mÉ™s: 500" />
        <div style="height:8px"></div>
        <label class="muted">ÅÉ™hÉ™r/yer</label>
        <input id="locationFilter" class="input" placeholder="mÉ™s: BakÄ±" />
        <div style="height:8px"></div>
        <label class="muted">VÉ™ziyyÉ™t</label>
        <select id="conditionFilter">
          <option value="">FÉ™rq etmir</option>
          <option>Yeni</option>
          <option>Ä°ÅŸlÉ™nmiÅŸ</option>
        </select>
        <div class="divider"></div>
        <div class="pill">ğŸ”” MÉ™slÉ™hÉ™t: axtarÄ±ÅŸdan sonra Enter</div>
      </aside>

      <section class="content">
        <div id="stats" class="muted" style="margin-bottom:8px">0 elan tapÄ±ldÄ±</div>
        <div id="cards" class="cards" aria-live="polite"></div>
      </section>
    </div>
  </main>

  <footer>
    Â© <span id="year"></span> Top Sales â€” SadÉ™ elan platformasÄ±. Yerli yaddaÅŸdan (LocalStorage) istifadÉ™ edir.
  </footer>

  <dialog id="createModal" aria-labelledby="modalTitle">
    <form method="dialog" id="adForm">
      <div class="modal-header">
        <div>
          <div id="modalTitle" class="title">Yeni elan</div>
          <div class="muted">MÉ™lumatlarÄ± doldur vÉ™ dÉ™rc et</div>
        </div>
        <button type="button" id="closeModal" class="btn btn-ghost">âœ–</button>
      </div>
      <div class="modal-body">
        <div class="two">
          <div>
            <label>BaÅŸlÄ±q</label>
            <input class="input" name="title" required placeholder="mÉ™s: iPhone 13 128GB" />
          </div>
          <div>
            <label>QiymÉ™t (AZN)</label>
            <input class="input" name="price" type="number" min="0" step="1" required placeholder="mÉ™s: 750" />
          </div>
          <div>
            <label>Kateqoriya</label>
            <select class="input" name="category" required>
              <option disabled selected value="">SeÃ§in</option>
              <option>Telefon & Elektronika</option>
              <option>DaÅŸÄ±nmaz É™mlak</option>
              <option>NÉ™qliyyat</option>
              <option>Geyim & Aksesuar</option>
              <option>Ev & BaÄŸ</option>
              <option>UÅŸaq DÃ¼nyasÄ±</option>
              <option>Hobbi & Ä°dman</option>
              <option>DigÉ™r</option>
            </select>
          </div>
          <div>
            <label>ÅÉ™hÉ™r/yer</label>
            <input class="input" name="location" required placeholder="mÉ™s: BakÄ±, Nizami" />
          </div>
        </div>
        <div style="height:8px"></div>
        <div>
          <label>VÉ™ziyyÉ™t</label>
          <select class="input" name="condition" required>
            <option>Yeni</option>
            <option>Ä°ÅŸlÉ™nmiÅŸ</option>
          </select>
        </div>
        <div style="height:8px"></div>
        <div>
          <label>TÉ™svir</label>
          <textarea class="input" name="description" rows="4" placeholder="ÆtraflÄ± mÉ™lumat yazÄ±n" required></textarea>
        </div>
        <div style="height:8px"></div>
        <div>
          <label>ÆlaqÉ™ (telefon vÉ™ ya e-poÃ§t)</label>
          <input class="input" name="contact" placeholder="mÉ™s: 0501234567" required />
        </div>
        <div style="height:12px"></div>
        <div>
          <label>ÅÉ™killÉ™r (max 8)</label>
          <input id="imagesInput" class="input" type="file" accept="image/*" multiple />
          <div class="preview" id="imgPreview" style="margin-top:8px"></div>
        </div>
        <div class="divider"></div>
        <div style="display:flex;justify-content:flex-end;gap:8px">
          <button type="button" class="btn btn-ghost" id="resetForm">TÉ™mizlÉ™</button>
          <button type="submit" class="btn btn-primary">DÉ™rc et</button>
        </div>
      </div>
    </form>
  </dialog>

  <template id="cardTpl">
    <article class="card">
      <div class="thumb">
        <span class="badge">Yeni</span>
        <button class="fav" title="SeÃ§ilmiÅŸlÉ™rÉ™ É™lavÉ™ et">â™¡</button>
        <img alt="Elan ÅŸÉ™kli" />
      </div>
      <div class="card-body">
        <div class="title"></div>
        <div class="muted meta"></div>
        <div class="price"></div>
        <div class="muted desc"></div>
        <div style="display:flex;gap:6px;justify-content:space-between;align-items:center">
          <div class="muted views"></div>
          <div style="display:flex;gap:6px">
            <button class="btn btn-ghost btn-sm call">ğŸ“ ÆlaqÉ™</button>
            <button class="btn btn-ghost btn-sm edit">âœï¸</button>
            <button class="btn btn-danger btn-sm del">ğŸ—‘ï¸</button>
          </div>
        </div>
      </div>
    </article>
  </template>

  <script>
  const $ = (q, el=document) => el.querySelector(q);
  const $$ = (q, el=document) => Array.from(el.querySelectorAll(q));
  const formatPrice = (n) => new Intl.NumberFormat('az-Latn-AZ',{style:'currency',currency:'AZN',maximumFractionDigits:0}).format(n);
  const uid = () => Math.random().toString(36).slice(2) + Date.now().toString(36);

  const STORE_KEY = 'topsales_listings_v1';
  const THEME_KEY = 'topsales_theme';
  let listings = JSON.parse(localStorage.getItem(STORE_KEY) || '[]');
  let editingId = null;

  const applyTheme = (mode) => {
    document.documentElement.classList.toggle('light', mode === 'light');
    localStorage.setItem(THEME_KEY, mode);
  }
  $('#toggleTheme').addEventListener('click', ()=>{
    const cur = localStorage.getItem(THEME_KEY) || 'dark';
    applyTheme(cur==='dark'?'light':'dark');
  });
  applyTheme(localStorage.getItem(THEME_KEY) || 'dark');

  $('#year').textContent = new Date().getFullYear();

  const modal = $('#createModal');
  $('#openCreate').addEventListener('click', ()=>{ openCreate(); });
  $('#closeModal').addEventListener('click', ()=>{ modal.close(); resetForm(); editingId=null;});

  function openCreate(data){
    $('#modalTitle').textContent = data? 'ElanÄ± redaktÉ™ et' : 'Yeni elan';
    if (typeof modal.showModal === 'function') {
      modal.showModal();
    } else {
      alert('Sizin brauzer \"dialog\" dÉ™stÉ™klÉ™mir. Form aÅŸaÄŸÄ±da aÃ§Ä±lacaq.');
      modal.setAttribute('open','open');
    }
    if(data){
      const f = $('#adForm');
      f.title.value = data.title;
      f.price.value = data.price;
      f.category.value = data.category;
      f.location.value = data.location;
      f.condition.value = data.condition;
      f.description.value = data.description;
      f.contact.value = data.contact;
      renderPreview(data.images || []);
    }
  }

  function resetForm(){
    const f = $('#adForm'); f.reset(); $('#imgPreview').innerHTML=''; $('#imagesInput').value='';
  }
  $('#resetForm').addEventListener('click', resetForm);

  let selectedImages = [];
  $('#imagesInput').addEventListener('change', async (e)=>{
    const files = Array.from(e.target.files || []).slice(0,8);
    selectedImages = await Promise.all(files.map(file => fileToDataUrl(file)));
    renderPreview(selectedImages);
  });
  function renderPreview(images){
    const box = $('#imgPreview'); box.innerHTML='';
    (images||[]).forEach(src=>{
      const d = document.createElement('div');
      const img = new Image(); img.src = src; d.appendChild(img); box.appendChild(d);
    });
  }
  function fileToDataUrl(file){
    return new Promise((res,rej)=>{ const r=new FileReader(); r.onload=()=>res(r.result); r.onerror=rej; r.readAsDataURL(file); });
  }

  $('#adForm').addEventListener('submit', (e)=>{
    e.preventDefault();
    const f = e.target;
    const data = {
      id: editingId || uid(),
      title: f.title.value.trim(),
      price: Number(f.price.value||0),
      category: f.category.value,
      location: f.location.value.trim(),
      condition: f.condition.value,
      description: f.description.value.trim(),
      contact: f.contact.value.trim(),
      images: selectedImages.length? selectedImages : (editingId? (listings.find(x=>x.id===editingId)?.images||[]) : []),
      createdAt: editingId? (listings.find(x=>x.id===editingId)?.createdAt) : Date.now(),
      views: editingId? (listings.find(x=>x.id===editingId)?.views||0) : 0
    };
    if(!data.title || !data.price || !data.category){ alert('ZÉ™hmÉ™t olmasa bÃ¼tÃ¼n tÉ™lÉ™b olunan sahÉ™lÉ™ri doldurun.'); return; }

    if(editingId){
      listings = listings.map(item => item.id===editingId? {...item, ...data}: item);
    } else {
      listings.unshift(data);
    }
    localStorage.setItem(STORE_KEY, JSON.stringify(listings));
    if (typeof modal.close === 'function') modal.close();
    resetForm(); editingId=null; selectedImages=[]; render();
  });

  $('#searchForm').addEventListener('submit', (e)=>{ e.preventDefault(); render(); });
  $('#categoryFilter').addEventListener('change', render);
  $('#sort').addEventListener('change', render);
  $('#maxPrice').addEventListener('input', debounce(render,300));
  $('#locationFilter').addEventListener('input', debounce(render,300));
  $('#conditionFilter').addEventListener('change', render);
  $('#quickCats').addEventListener('click', (e)=>{
    if(!e.target.classList.contains('chip')) return;
    const cat = e.target.getAttribute('data-cat');
    $('#categoryFilter').value = cat; render();
    $$('#quickCats .chip').forEach(c=>c.classList.toggle('active', c===e.target));
  });

  function getFilters(){
    const q = $('#q').value.toLowerCase().trim();
    const cat = $('#categoryFilter').value;
    const sort = $('#sort').value;
    const maxP = Number($('#maxPrice').value||0);
    const loc = $('#locationFilter').value.toLowerCase().trim();
    const cond = $('#conditionFilter').value;
    let data = [...listings];
    if(q){ data = data.filter(x => (x.title + ' ' + x.description).toLowerCase().includes(q)); }
    if(cat){ data = data.filter(x => x.category===cat); }
    if(maxP>0){ data = data.filter(x => x.price <= maxP); }
    if(loc){ data = data.filter(x => x.location.toLowerCase().includes(loc)); }
    if(cond){ data = data.filter(x => x.condition===cond); }
    if(sort==='price-asc') data.sort((a,b)=>a.price-b.price);
    else if(sort==='price-desc') data.sort((a,b)=>b.price-a.price);
    else if(sort==='title-asc') data.sort((a,b)=>a.title.localeCompare(b.title));
    else data.sort((a,b)=>b.createdAt-a.createdAt);
    return data;
  }

  function render(){
    const data = getFilters();
    $('#stats').textContent = `${data.length} elan tapÄ±ldÄ±`;
    const wrap = $('#cards'); wrap.innerHTML='';
    if(!data.length){ wrap.innerHTML = `<div class="pill">HeÃ§ nÉ™ tapÄ±lmadÄ±. Yeni elan É™lavÉ™ et! â•</div>`; return; }

    const tpl = $('#cardTpl');
    data.forEach(item=>{
      const node = tpl.content.cloneNode(true);
      const card = node.querySelector('.card');
      const img = node.querySelector('img');
      img.src = item.images?.[0] || placeholderFromTitle(item.title);
      node.querySelector('.badge').textContent = item.condition || 'Elan';
      node.querySelector('.title').textContent = item.title;
      node.querySelector('.meta').textContent = `${item.location} â€¢ ${new Date(item.createdAt).toLocaleDateString('az-Latn-AZ')}`;
      node.querySelector('.price').textContent = formatPrice(item.price);
      node.querySelector('.desc').textContent = item.description.slice(0,80) + (item.description.length>80?'â€¦':'');
      node.querySelector('.views').textContent = `ğŸ‘ï¸ ${item.views||0}`;

      const favBtn = node.querySelector('.fav');
      favBtn.textContent = (item.fav?'â¤ï¸':'â™¡');
      favBtn.addEventListener('click', (e)=>{ e.stopPropagation(); item.fav=!item.fav; save(); render(); });

      node.querySelector('.call').addEventListener('click', (e)=>{ e.stopPropagation(); 
        if(item.contact.startsWith('0')||item.contact.startsWith('+')){
          window.location.href = `tel:${item.contact}`;
        } else if(item.contact.includes('@')){
          window.location.href = `mailto:${item.contact}?subject=Top%20Sales%20Elan%20(${encodeURIComponent(item.title)})`;
        } else { alert(`ÆlaqÉ™: ${item.contact}`); }
      });

      node.querySelector('.edit').addEventListener('click', (e)=>{ e.stopPropagation(); editingId=item.id; openCreate(item); selectedImages = item.images || []; });
      node.querySelector('.del').addEventListener('click', (e)=>{ e.stopPropagation(); if(confirm('Bu elanÄ± silmÉ™k istÉ™yirsÉ™n?')){ listings = listings.filter(x=>x.id!==item.id); save(); render(); }});

      card.addEventListener('click', ()=>{ item.views=(item.views||0)+1; save(); quickView(item); });

      wrap.appendChild(node);
    });
  }

  function placeholderFromTitle(title){
    const t = encodeURIComponent((title||'Elan').slice(0,12));
    const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='600' height='400'>\
      <defs><linearGradient id='g' x1='0' y1='0' x2='1' y2='1'><stop stop-color='%236ee7b7' offset='0'/><stop stop-color='%2322d3ee' offset='1'/></linearGradient></defs>\
      <rect width='600' height='400' fill='url(%23g)'/>\
      <text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' font-size='38' font-family='Inter,Segoe UI,Arial' fill='black' opacity='.6'>${t}</text>\
    </svg>`;
    return 'data:image/svg+xml;utf8,' + svg;
  }

  function quickView(item){
    const msg = `${item.title}\n${formatPrice(item.price)} â€” ${item.location}\n\n${item.description}\n\nÆlaqÉ™: ${item.contact}`;
    if(confirm(msg + "\n\nElanÄ± redaktÉ™ etmÉ™k istÉ™yirsÉ™n?")){
      editingId=item.id; openCreate(item);
    }
  }

  function save(){ localStorage.setItem(STORE_KEY, JSON.stringify(listings)); }

  document.getElementById('loadDemo').addEventListener('click', ()=>{
    if(!confirm('Demo elanlarÄ± yÃ¼klÉ™nsin? MÃ¶vcud elanlara É™lavÉ™ olunacaq.')) return;
    const now = Date.now();
    const uid2 = uid;
    const demo = [
      {id:uid2(), title:'iPhone 13 128GB', price:780, category:'Telefon & Elektronika', location:'BakÄ±', condition:'Ä°ÅŸlÉ™nmiÅŸ', description:'YaxÅŸÄ± vÉ™ziyyÉ™tdÉ™dir, Face ID iÅŸlÉ™yir. Adapter + kabel hÉ™diyyÉ™.', contact:'+994501234567', images:[], createdAt: now-86400000*1, views:5},
      {id:uid2(), title:'KirayÉ™ 2 otaqlÄ±, XÉ™tai', price:450, category:'DaÅŸÄ±nmaz É™mlak', location:'BakÄ±, XÉ™tai', condition:'Ä°ÅŸlÉ™nmiÅŸ', description:'Metroya 5 dÉ™q, É™ÅŸyalÄ±dÄ±r. Kommunal daxil deyil.', contact:'elan@example.com', images:[], createdAt: now-86400000*3, views:10},
      {id:uid2(), title:'Hyundai Elantra 2014', price:16500, category:'NÉ™qliyyat', location:'SumqayÄ±t', condition:'Ä°ÅŸlÉ™nmiÅŸ', description:'1.8 benzin, avtomat, xÉ™rci yoxdur. Barter mÃ¼mkÃ¼ndÃ¼r.', contact:'+994707777777', images:[], createdAt: now-86400000*8, views:3},
      {id:uid2(), title:'Balkon Ã¼Ã§Ã¼n oturacaq', price:55, category:'Ev & BaÄŸ', location:'GÉ™ncÉ™', condition:'Yeni', description:'Taxta, dÉ™mir ayaqlÄ±, Ã§ox rahatdÄ±r.', contact:'+994551112233', images:[], createdAt: now-86400000*12, views:1},
    ];
    listings = demo.concat(listings);
    save(); render();
  });

  document.getElementById('exportBtn').addEventListener('click', ()=>{
    const blob = new Blob([JSON.stringify(listings,null,2)], {type:'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = 'topsales-data.json'; a.click(); URL.revokeObjectURL(url);
  });

  document.getElementById('importInput').addEventListener('change', async (e)=>{
    const file = e.target.files?.[0]; if(!file) return;
    const text = await file.text();
    try{ const data = JSON.parse(text); if(!Array.isArray(data)) throw new Error('Format sÉ™hvdir');
      listings = data; save(); render(); alert('UÄŸurla idxal edildi!');
    }catch(err){ alert('JSON oxunmadÄ±: ' + err.message); }
  });

  document.getElementById('clearAll').addEventListener('click', ()=>{
    if(confirm('BÃ¼tÃ¼n elanlar silinsin?')){ listings = []; save(); render(); }
  });

  render();

  function debounce(fn, ms){ let t; return (...a)=>{ clearTimeout(t); t=setTimeout(()=>fn.apply(this,a), ms); } }
  </script>
</body>
</html>
